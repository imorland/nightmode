{"version":3,"sources":["webpack://@fof/nightmode/webpack/bootstrap","webpack://@fof/nightmode/./forum.js","webpack://@fof/nightmode/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/nightmode/./src/forum/addMenuItems.js","webpack://@fof/nightmode/./src/forum/addSettingsItems.js","webpack://@fof/nightmode/./src/forum/components/AutoThemeModal.js","webpack://@fof/nightmode/./src/forum/index.js","webpack://@fof/nightmode/external \"flarum.core.compat['Model']\"","webpack://@fof/nightmode/external \"flarum.core.compat['app']\"","webpack://@fof/nightmode/external \"flarum.core.compat['components/Button']\"","webpack://@fof/nightmode/external \"flarum.core.compat['components/Modal']\"","webpack://@fof/nightmode/external \"flarum.core.compat['components/Page']\"","webpack://@fof/nightmode/external \"flarum.core.compat['components/SessionDropdown']\"","webpack://@fof/nightmode/external \"flarum.core.compat['components/SettingsPage']\"","webpack://@fof/nightmode/external \"flarum.core.compat['components/Switch']\"","webpack://@fof/nightmode/external \"flarum.core.compat['extend']\"","webpack://@fof/nightmode/external \"flarum.core.compat['models/User']\"","webpack://@fof/nightmode/external \"flarum.core.compat['tags/components/TagsPage']\"","webpack://@fof/nightmode/external \"flarum.core.compat['utils/KeyboardNavigatable']\""],"names":["DisplayOledPromptIfNeeded","_app","oledSwitched","darkModeTurningOff","darkModeTurningOn","app","session","user","canUseDarkMode","canChangeDarkModeType","fofNightModeOledType","preferences","fofNightMode","ls","window","localStorage","getItem","shouldShowOledPrompt","$","length","banner","document","createElement","className","innerHTML","translator","trans","a1","a2","join","body","appendChild","click","matchMedia","matches","focus","$toggleBtn","parent","css","addClass","remove","setItem","extend","SessionDropdown","prototype","items","lightState","oledState","add","Button","component","icon","href","children","onclick","savePreferences","fofNightModeOverrideAuto","toggleClass","Page","SettingsPage","Switch","state","onchange","value","preferenceSaver","AutoThemeModal","isDismissible","init","selected","filter","m","prop","focused","option","title","content","e","preventDefault","stopPropagation","onButtonClick","onsubmit","props","modal","close","redraw","strategy","Modal","initializers","User","Model","attribute","addSettingsItems","HandleModalSubmit","removeClass","show","TagsPage","addMenuItems"],"mappings":"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","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","/*\n * This file is part of Flarum.\n *\n * (c) Toby Zerner <toby.zerner@gmail.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nexport * from './src/forum';\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import { extend } from \"flarum/extend\";\nimport SessionDropdown from \"flarum/components/SessionDropdown\";\nimport Button from \"flarum/components/Button\";\nimport Page from \"flarum/components/Page\";\n\nexport default function() {\n    function DisplayOledPromptIfNeeded(\n        _app,\n        oledSwitched = false,\n        darkModeTurningOff = false,\n        darkModeTurningOn = false\n    ) {\n        if (\n            !app.session.user ||\n            !_app.session.user.canUseDarkMode() ||\n            !_app.session.user.canChangeDarkModeType()\n        )\n            return;\n\n        let fofNightModeOledType = _app.session.user.preferences()\n            .fofNightModeOledType;\n        let fofNightMode = _app.session.user.preferences().fofNightMode;\n        let ls = window.localStorage.getItem(\n            \"giffgaff_darkmode_oledpromptshown\"\n        )\n            ? false\n            : true;\n\n        const shouldShowOledPrompt =\n            !oledSwitched &&\n            (!(darkModeTurningOff || !fofNightMode) || darkModeTurningOn) &&\n            !fofNightModeOledType &&\n            ls;\n\n        // dark mode must be enabled, oled prompt should be shown, and isn't already shown\n        if (\n            shouldShowOledPrompt &&\n            $(\"section.ggDarkModeBanner\").length === 0\n        ) {\n            let banner = document.createElement(\"section\");\n            banner.className = \"ggDarkModeBanner\";\n            banner.innerHTML =\n                _app.translator\n                    .trans(\"fof-nightmode.forum.oled_banner\", {\n                        a1: `<a href='#' class=\"blackmodebannershow\">`,\n                        a2: `</a>`\n                    })\n                    .join(\"\") +\n                ` <a href=\"#\" class=\"dismiss-btn\" title=\"Dismiss alert\"><i class=\"fas fa-times\"></i></a>`;\n\n            document.body.appendChild(banner);\n\n            $(\"section.ggDarkModeBanner a.blackmodebannershow\").click(\n                function() {\n                    if (window.matchMedia(\"(min-width: 768px)\").matches) {\n                        $(\n                            \"#header-secondary > ul > li.item-session > div > button.Button--user\"\n                        ).click();\n                        \"#header-secondary > ul > li.item-session > div > ul > li.item-toggleOledDarkMode > button\".focus();\n                    } else {\n                        // small screen\n                        while (\n                            $(\n                                \".App-backControl .Button.Navigation-back.Button--icon.hasIcon\"\n                            ).length > 0\n                        ) {\n                            $(\n                                \".App-backControl .Button.Navigation-back.Button--icon.hasIcon\"\n                            ).click();\n                        }\n\n                        $(\n                            \".App-backControl .Button.Button--icon.Navigation-drawer.hasIcon\"\n                        ).click();\n                        $(\n                            \"#header-secondary > ul > li.item-session > div > button.Button--user\"\n                        ).click();\n                        \n                        let $toggleBtn = $(\n                            \"#header-secondary > ul > li.item-session > div > ul > li.item-toggleOledDarkMode > button\"\n                        );\n                        $toggleBtn.parent().css(\"overflow\", \"hidden\");\n                        $toggleBtn.addClass(\"pulsate\");\n                    }\n                    return false;\n                }\n            );\n\n            $(\"section.ggDarkModeBanner a.dismiss-btn\").click(function() {\n                $(\"section.ggDarkModeBanner\").remove();\n\n                window.localStorage.setItem(\n                    \"giffgaff_darkmode_oledpromptshown\",\n                    true\n                );\n\n                return false;\n            });\n        } else if ($(\"section.ggDarkModeBanner\").length > 0) {\n            $(\"section.ggDarkModeBanner\").remove();\n        }\n    }\n\n    extend(SessionDropdown.prototype, \"items\", function(items) {\n        if (app.session.user.canUseDarkMode()) {\n            let lightState =\n                app.session.user.preferences().fofNightMode == true\n                    ? false\n                    : true;\n\n            let oledState =\n                app.session.user.canChangeDarkModeType() &&\n                app.session.user.preferences().fofNightModeOledType == true\n                    ? true\n                    : false;\n\n            // Add night mode link to session dropdown\n            items.add(\n                app.session.user && app.session.user.preferences().fofNightMode\n                    ? \"nightmode\"\n                    : \"daymode\",\n                Button.component({\n                    icon: lightState == true ? \"fas fa-moon\" : \"fas fa-sun\",\n                    href: \"javascript:;\",\n                    children:\n                        lightState == true\n                            ? app.translator.trans(\"fof-nightmode.forum.night\")\n                            : app.translator.trans(\"fof-nightmode.forum.day\"),\n                    onclick: function() {\n                        DisplayOledPromptIfNeeded(\n                            app,\n                            false,\n                            !lightState,\n                            lightState\n                        );\n\n                        // Toggle night mode on or off by changing the user preference\n                        app.session.user.savePreferences({\n                            fofNightMode: lightState,\n                            fofNightModeOverrideAuto: true\n                        });\n\n                        $(\"body\").toggleClass(\"dark\");\n                    }\n                }),\n                -1\n            );\n\n            if (app.session.user.canChangeDarkModeType() && !lightState) {\n                // Add night mode link to session dropdown\n                items.add(\n                    \"toggleOledDarkMode\",\n                    Button.component({\n                        icon: \"far fa-moon\",\n                        children: oledState\n                            ? app.translator.trans(\n                                  \"fof-nightmode.forum.user.settings.oled_off\"\n                              )\n                            : app.translator.trans(\n                                  \"fof-nightmode.forum.user.settings.oled_on\"\n                              ),\n                        onclick: () => {\n                            DisplayOledPromptIfNeeded(app, true);\n\n                            // console.log(`OLED mode state: ${!oledState}`);\n\n                            // Toggle night mode on or off by changing the user preference\n                            app.session.user.savePreferences({\n                                fofNightModeOledType: !oledState\n                            });\n\n                            $(\"body\").toggleClass(\"dark--oled\");\n                        }\n                    }),\n                    -1\n                );\n            }\n        }\n    });\n\n    extend(Page.prototype, \"init\", function() {\n        DisplayOledPromptIfNeeded(app);\n    });\n}\n","import {extend} from 'flarum/extend';\nimport SettingsPage from 'flarum/components/SettingsPage';\nimport Switch from \"flarum/components/Switch\";\n\nexport default function () {\n    extend(SettingsPage.prototype, 'accountItems', function (items) {\n        items.add('theme-switch',\n            Switch.component({\n                children: app.translator.trans('fof-nightmode.forum.user.settings.dark_mode'),\n                state: !app.session.user.preferences().fofNightMode,\n                onchange: (value, component) => this.preferenceSaver('fofNightMode')(!value, component)\n            })\n        )\n    });\n}\n","import Modal from \"flarum/components/Modal\";\nimport Button from \"flarum/components/Button\";\nimport KeyboardNavigatable from \"flarum/utils/KeyboardNavigatable\";\n\nexport default class AutoThemeModal extends Modal {\n    isDismissible() {\n        return false;\n    }\n\n    init() {\n        super.init();\n\n        this.selected = [];\n        this.filter = m.prop(\"\");\n        this.focused = false;\n\n        this.option = true;\n\n        // TODO: Make keyboard accessible\n        // this.navigator = new KeyboardNavigatable();\n        // this.navigator\n        //     .onUp(() => this.setIndex(this.getCurrentNumericIndex() - 1, true))\n        //     .onDown(() =>\n        //         this.setIndex(this.getCurrentNumericIndex() + 1, true)\n        //     )\n        //     .onSelect(this.select.bind(this))\n        //     .onRemove(() => this.selected.splice(this.selected.length - 1, 1));\n    }\n\n    className() {\n        return \"ggNightModeModal\";\n    }\n\n    title() {\n        return app.translator.trans(\n            \"fof-nightmode.forum.auto_theme.dialog.title\"\n        );\n    }\n\n    content() {\n        return [\n            <div className=\"Modal-body\">\n                <div className=\"ggNightModeModal--auto-theme\">\n                    <p className=\"ggNightModeModal--paragraph\">\n                        {app.translator.trans(\n                            \"fof-nightmode.forum.auto_theme.dialog.message\"\n                        )}\n                    </p>\n                    <p className=\"ggNightModeModal--paragraph\">\n                        <strong>\n                            {app.translator.trans(\n                                \"fof-nightmode.forum.auto_theme.dialog.prompt\"\n                            )}\n                        </strong>\n                    </p>\n                </div>\n\n                <div className=\"Form Form--centered\">\n                    <div className=\"Form-group\">\n                        {Button.component({\n                            className: \"Button Button--primary\",\n                            icon: \"fas fa-check\",\n                            children: app.translator.trans(\n                                \"fof-nightmode.forum.auto_theme.dialog.keep_enabled_btn\"\n                            ),\n                            onclick: e => {\n                                e.preventDefault();\n                                e.stopPropagation();\n                                this.onButtonClick(\"keep\");\n                            }\n                        })}\n                    </div>\n\n                    <div className=\"Form-group\">\n                        {Button.component({\n                            className: \"Button Button--primary Button--cancel\",\n                            icon: \"fas fa-times\",\n                            children: app.translator.trans(\n                                \"fof-nightmode.forum.auto_theme.dialog.turn_off_btn\"\n                            ),\n                            onclick: e => {\n                                e.preventDefault();\n                                e.stopPropagation();\n                                this.onButtonClick(\"undo\");\n                            }\n                        })}\n                    </div>\n                </div>\n            </div>,\n\n            <div className=\"Modal-footer\">\n                <p className=\"ggNightModeModal--note\">\n                    <span className=\"ggNightModeModal-note--large-screen\">\n                        {app.translator.trans(\n                            \"fof-nightmode.forum.auto_theme.dialog.note\"\n                        )}\n                    </span>\n                    <span className=\"ggNightModeModal-note--small-screen\">\n                        {app.translator.trans(\n                            \"fof-nightmode.forum.auto_theme.dialog.note_mobile\"\n                        )}\n                    </span>\n                </p>\n            </div>\n        ];\n    }\n\n    onsubmit(e) {\n        e.preventDefault();\n    }\n\n    onButtonClick(e) {\n        if (this.props.onsubmit) this.props.onsubmit(e);\n\n        app.modal.close();\n        m.redraw.strategy(\"none\");\n    }\n}\n","import { extend } from \"flarum/extend\";\nimport app from \"flarum/app\";\nimport Page from \"flarum/components/Page\";\nimport TagsPage from \"flarum/tags/components/TagsPage\";\nimport Model from \"flarum/Model\";\nimport User from \"flarum/models/User\";\n\nimport addMenuItems from \"./addMenuItems\";\nimport AutoThemeModal from \"./components/AutoThemeModal\";\nimport addSettingsItems from \"./addSettingsItems\";\n\napp.initializers.add(\"fof-nightmode\", app => {\n    User.prototype.canUseDarkMode = Model.attribute(\"canUseDarkMode\");\n    User.prototype.canChangeDarkModeType = Model.attribute(\n        \"canChangeDarkModeType\"\n    );\n\n    addSettingsItems();\n\n    extend(Page.prototype, \"init\", function() {\n        function HandleModalSubmit(e) {\n            if (e === \"keep\") {\n                // keep auto theme (i.e. i like my retinas being perfectly healthy)\n\n                app.session.user.savePreferences({\n                    fofNightMode: true,\n                    fofNightModeOverrideAuto: false\n                });\n            } else {\n                // go back to light mode (i.e. i like burning my retinas)\n\n                app.session.user.savePreferences({\n                    fofNightMode: false,\n                    fofNightModeOverrideAuto: true\n                });\n\n                $(\"body\").removeClass(\"dark\");\n            }\n        }\n\n        if (\n            app.session.user &&\n            app.session.user.canUseDarkMode() &&\n            app.session.user.preferences().fofNightMode\n        ) {\n            $(\"body\").addClass(\"dark\");\n        } else if (\n            (!app.session.user ||\n                (app.session.user &&\n                    !app.session.user.preferences()\n                        .fofNightModeOverrideAuto)) &&\n            window.matchMedia(\"(prefers-color-scheme: dark)\").matches\n        ) {\n            $(\"body\").addClass(\"dark\");\n\n            // show dialog asking logged in user if they wish\n            // to override detected theme\n            if (app.session.user) {\n                app.modal.show(\n                    new AutoThemeModal({ onsubmit: HandleModalSubmit })\n                );\n            }\n        } else {\n            $(\"body\").removeClass(\"dark\");\n        }\n\n        if (\n            app.session.user &&\n            app.session.user.canUseDarkMode() &&\n            app.session.user.canChangeDarkModeType() &&\n            app.session.user.preferences().fofNightModeOledType\n        ) {\n            $(\"body\").addClass(\"dark--oled\");\n        } else {\n            $(\"body\").removeClass(\"dark--oled\");\n        }\n    });\n\n    if (TagsPage) {\n        function HandleModalSubmit(e) {}\n\n        extend(TagsPage.prototype, \"config\", function() {\n            if (\n                app.session.user &&\n                app.session.user.canUseDarkMode() &&\n                app.session.user.preferences().fofNightMode\n            ) {\n                $(\"body\").addClass(\"dark\");\n            } else if (\n                (!app.session.user ||\n                    (app.session.user &&\n                        !app.session.user.preferences()\n                            .fofNightModeOverrideAuto)) &&\n                window.matchMedia(\"(prefers-color-scheme: dark)\").matches\n            ) {\n                $(\"body\").addClass(\"dark\");\n\n                // show dialog asking logged in user if they wish\n                // to override detected theme\n                if (app.session.user) {\n                    app.modal.show(\n                        new AutoThemeModal({ onsubmit: HandleModalSubmit })\n                    );\n                }\n            } else {\n                $(\"body\").removeClass(\"dark\");\n            }\n\n            if (\n                app.session.user &&\n                app.session.user.canUseDarkMode() &&\n                app.session.user.canChangeDarkModeType() &&\n                app.session.user.preferences().fofNightModeOledType\n            ) {\n                $(\"body\").addClass(\"dark--oled\");\n            } else {\n                $(\"body\").removeClass(\"dark--oled\");\n            }\n        });\n    }\n\n    addMenuItems();\n});\n","module.exports = flarum.core.compat['Model'];","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/Modal'];","module.exports = flarum.core.compat['components/Page'];","module.exports = flarum.core.compat['components/SessionDropdown'];","module.exports = flarum.core.compat['components/SettingsPage'];","module.exports = flarum.core.compat['components/Switch'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['models/User'];","module.exports = flarum.core.compat['tags/components/TagsPage'];","module.exports = flarum.core.compat['utils/KeyboardNavigatable'];"],"sourceRoot":""}